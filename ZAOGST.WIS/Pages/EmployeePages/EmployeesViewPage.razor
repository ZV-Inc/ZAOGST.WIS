@page "/employeesview"
@attribute [Authorize(Roles = UserRoles.Admin)]
@inject IUserService UserService
@inject NavigationManager NavigationManager

<PageTitle>Сотрудники</PageTitle>

<h3>Сотрудники</h3>

<button @onclick=CreateNewUser class="btn btn-primary">Добавить сотрудника</button>

<br />
<br />

<Table TableItem="User" Items="_userData" PageSize="15" RowClickAction="RowClick" class="table table-striped table-sm table-bordered">
	<Column TableItem="User" Title="Логин" Field="@(x => x.Username)" Sortable="true" Filterable="true" Width="10%" />
	<Column TableItem="User" Title="Роль" Field="@(x => x.Role)" Sortable="true" Filterable="true" Width="10%" />
	<Column TableItem="User" Title="Дата добавления" Field="@(x => x.DateAdded)" Sortable="true" Filterable="true" Width="20%" />
	<Pager ShowPageNumber="true"></Pager>
</Table>

@code {
	private List<User> _userData = new();

	protected override async Task OnInitializedAsync()
	{
		List<User> list = await UserService.GetList();

		_userData = list.OrderBy(x => x.Id).ToList();
	}

	private void RowClick(User user)
	{
		NavigationManager.NavigateTo($"/employeeupdate/{user.Id}");
	}

	private void CreateNewUser()
	{
		NavigationManager.NavigateTo("/employeecreate");
	}
}
